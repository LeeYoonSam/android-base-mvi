# 모듈화 학습

이 학습 여정에서는 모듈화에 대해 알아보고 Android 앱에서 모듈을 만드는 데 사용되는 모듈화 전략에 대해 알아봅니다.


## 개요

모듈화는 모놀리식 단일 모듈 코드베이스의 개념을 느슨하게 결합된 독립된 모듈로 분리하는 작업입니다.


### 모듈화의 이점

이를 통해 다음과 같은 많은 이점을 얻을 수 있습니다:

**확장성** - 긴밀하게 결합된 코드베이스에서는 한 번의 변경으로 인해 일련의 변경이 발생할 수 있습니다. 
적절하게 모듈화된 프로젝트는 [관심사 분리] https://en.wikipedia.org/wiki/Separation_of_concerns) 원칙을 수용합니다. 
이는 결과적으로 기여자에게 더 많은 자율성을 부여하는 동시에 아키텍처 패턴을 강제합니다.

**병렬 작업 가능** - 모듈화는 버전 관리 충돌을 줄이고 대규모 팀의 개발자가 보다 효율적으로 병렬 작업을 할 수 있도록 도와줍니다.

**소유권** - 모듈에는 코드 및 테스트 유지 관리, 버그 수정, 변경 사항 검토를 담당하는 전담 소유자가 있을 수 있습니다.

**캡슐화** - 격리된 코드는 읽기, 이해, 테스트 및 유지 관리가 더 쉽습니다.

**빌드 시간 단축** - Gradle의 병렬 및 증분 빌드를 활용하면 빌드 시간을 단축할 수 있습니다.

**동적 전달** - 모듈화는 앱의 특정 기능을 조건부로 전달하거나 필요에 따라 다운로드할 수 있는 
[Play 기능 전달](https://developer.android.com/guide/playcore/feature-delivery)을 위한 필수 요건 입니다.

**재사용성** - 적절한 모듈화를 통해 코드를 공유하고 동일한 기반에서 여러 플랫폼에 걸쳐 여러 앱을 빌드할 수 있습니다.


### 모듈화 함정

그러나 모듈화는 오용될 수 있는 패턴이며, 앱을 모듈화할 때 주의해야 할 몇 가지 문제가 있습니다:

**모듈이 너무 많은 경우** - 각 모듈에는 빌드 구성의 복잡성 증가라는 형태로 오버헤드가 발생합니다. 이로 인해 Gradle 동기화 시간이 길어지고 지속적인 유지 관리 비용이 발생할 수 있습니다. 
또한 모듈을 추가하면 단일 모놀리식 모듈과 비교할 때 프로젝트의 Gradle 설정이 더 복잡해집니다. 
규칙 플러그인을 사용하여 재사용 및 컴포저블이 가능한 빌드 구성을 유형 안전 Kotlin 코드로 추출하면 이러한 문제를 완화할 수 있습니다.

Now in Android 앱에서 이러한 규칙 플러그인은 [`build-logic` 폴더](https://github.com/android/nowinandroid/tree/main/build-logic)에서 찾을 수 있습니다.

**모듈이 충분하지 않은 경우** - 반대로 모듈이 적고, 크고, 긴밀하게 결합되어 있는 경우, 또 하나의 모놀리스가 만들어집니다. 
이는 모듈화의 이점을 일부 잃게 된다는 뜻입니다. 모듈이 비대하고 목적이 명확하지 않다면 모듈 분리를 고려해야 합니다.

**너무 복잡하다** - 여기에는 해결책이 없습니다. 
사실 프로젝트를 모듈화하는 것이 항상 합당한 것은 아닙니다. 가장 중요한 요소는 코드베이스의 크기와 상대적 복잡성입니다. 
프로젝트가 특정 임계값 이상으로 커질 것으로 예상되지 않는다면 확장성 및 빌드 시간 이득이 적용되지 않습니다.


## 모듈화 전략

모든 프로젝트에 적합한 단일 모듈화 전략은 없다는 점에 유의하는 것이 중요합니다. 그러나 이점을 극대화하고 단점을 최소화하기 위해 따를 수 있는 일반적인 지침이 있습니다.

- 베어본 모듈은 단순히 내부에 Gradle 빌드 스크립트가 있는 디렉터리입니다. 하지만 일반적으로 모듈은 하나 이상의 소스 세트와 리소스 또는 에셋 모음으로 구성됩니다. 
- 모듈은 독립적으로 빌드하고 테스트할 수 있습니다. 
- Gradle의 유연성 덕분에 프로젝트를 구성하는 방법에는 제약이 거의 없습니다. 
- 일반적으로 낮은 결합과 높은 응집력을 위해 노력해야 합니다.

**낮은 결합**
- 모듈은 가능한 한 서로 독립적이어야 하며, 한 모듈의 변경 사항이 다른 모듈에 미치는 영향이 전혀 없거나 최소화되어야 합니다. 
- 모듈은 다른 모듈의 내부 작동에 대한 지식을 가지고 있지 않아야 합니다.

**높은 응집력**
- 모듈은 하나의 시스템으로 작동하는 코드 모음으로 구성되어야 합니다. 
- 책임이 명확하게 정의되어 있어야 하며 특정 도메인 지식의 경계 내에 있어야 합니다. 
- 예를 들어 Now in Android의 [`core:network` 모듈](https://github.com/android/nowinandroid/tree/main/core/network)은 네트워크 요청, 원격 데이터 소스의 응답 처리, 다른 모듈에 데이터 공급을 담당합니다.
